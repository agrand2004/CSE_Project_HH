[env:due]
platform = atmelsam
board = dueUSB
framework = 

; Bare-metal configuration for Arduino Due (SAM3X8E)
build_flags = 
    -D__SAM3X8E__
    -DDONT_USE_CMSIS_INIT
    -DARM_MATH_CM3=true
    -mcpu=cortex-m3
    -mthumb
    -Os
    -ffunction-sections
    -fdata-sections
    -Iinclude
    -Wl,--gc-sections
    -Wl,--print-memory-usage

build_unflags = 
    -std=gnu++11

; Link flags for bare-metal SRAM execution
build_src_filter = 
    +<*>
    +<../src/*>

; J-Link debugging configuration
debug_tool = jlink
debug_init_break = tbreak main
debug_load_mode = always
debug_server =
    /usr/local/bin/JLinkGDBServer
    -singlerun
    -if
    SWD
    -select
    USB
    -device
    ATSAM3X8E
    -port
    2331

; Upload via J-Link
upload_protocol = jlink

; Extra scripts for custom linking
extra_scripts = 

; Linker flags
board_build.ldscript = linker_script.ld
